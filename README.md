# 音频质量分析工具 (Audio Quality Analyzer)

一个功能强大的音频文件质量分析工具，支持GPU加速，能够快速分析大量音频文件的质量参数、检测伪HiRes音频、识别重复文件，并生成美观的HTML和Excel报告。

## 功能特点

### 🚀 高性能处理
- **CUDA GPU加速**：自动检测NVIDIA GPU和CUDA支持，使用GPU加速处理音频文件
- **多线程并行分析**：CPU和GPU协同工作，最大化利用系统资源
- **高效文件扫描**：快速扫描指定目录下的所有音频文件

### 🎵 音频质量评估
- **音质等级划分**：根据采样率、位深度和格式自动评估音质等级
  - 超高解析度音频 (≥192kHz/24bit)
  - 高解析度音频 (≥48kHz/24bit)
  - CD音质 (44.1kHz/16bit)
  - 无损压缩音频
  - 有损压缩音频

### 🕵️ 智能检测功能
- **伪HiRes检测**：通过分析音频频谱特征，识别被拉伸或插值的伪高解析度音频
- **重复文件检测**：计算文件哈希值，快速识别重复的音频文件
- **音频响度分析**：使用EBU R128标准分析音频响度

### 📊 报告生成
- **精美HTML报告**：
  - 大气简约的现代化UI设计
  - 三种统计图表（音质等级分布、采样率分布、伪HiRes检测结果）
  - 实时筛选功能（按音质等级、伪HiRes检测结果）

- **Excel格式报告**：
  - 详细的音频文件信息表格
  - 支持排序和筛选
  - 便于进一步数据分析

## 系统要求

### 硬件要求
- CPU：支持多线程的现代处理器
- 内存：建议8GB以上
- 存储空间：足够的空间存储分析结果和临时文件
- GPU（可选）：支持CUDA的NVIDIA显卡（用于GPU加速）

### 软件要求
- **操作系统**：Windows 10/11
- **Python版本**：3.8及以上
- **依赖库**：
  - pandas
  - openpyxl
  - matplotlib
- **外部工具**：
  - FFmpeg（包含ffprobe）：用于音频文件分析

## 安装与配置

### 1. 安装Python
- 从[Python官方网站](https://www.python.org/)下载并安装Python 3.8或更高版本
- 确保勾选"Add Python to PATH"选项

### 2. 安装依赖库
```bash
pip install pandas openpyxl matplotlib
```

### 3. 安装FFmpeg
- 从[FFmpeg官方网站](https://ffmpeg.org/download.html)下载Windows版本的FFmpeg
- 解压后将`ffmpeg.exe`、`ffprobe.exe`所在目录添加到系统PATH环境变量

### 4. 下载程序
- 将三个Python文件（`audio_analyzer.py`、`cuda_detection.py`、`test_path.py`）复制到您的工作目录

## 使用方法

### 基本使用
1. 将需要分析的音频文件复制到程序所在目录
2. 运行程序：
```bash
python audio_analyzer.py
```
3. 程序将自动执行以下步骤：
   - 检测CUDA支持情况
   - 扫描目录下的音频文件
   - 并行分析音频文件的基础信息
   - 计算文件哈希值并检测重复文件
   - 生成HTML和Excel报告
   - 清理临时文件

### 高级使用
- 默认扫描当前目录下的所有音频文件
- 分析结果将保存在`Output`目录中
- 支持的音频格式：MP3、FLAC、WAV、M4A、AAC、OGG

## 输出结果说明

### HTML报告 (AudioReport.html)
- **统计概览**：显示总文件数、不同音质等级的文件数量
- **统计图表**：
  - 音质等级分布饼图
  - 采样率分布直方图
  - 伪HiRes检测结果柱状图
- **文件列表**：包含所有音频文件的详细信息
  - 文件名
  - 格式
  - 采样率
  - 位深度
  - 声道数
  - 音质等级
  - 伪HiRes检测结果
  - 响度数据
  - 大小
- **筛选功能**：
  - 按音质等级筛选（超高解析度、高解析度、CD音质等）
  - 按伪HiRes检测结果筛选（是/否/未知）

### Excel报告 (AudioReport.xlsx)
- 包含HTML报告中的所有详细信息
- 以表格形式呈现，便于数据处理和分析

## 项目结构

```
AudioQualityAnalyzer/
├── audio_analyzer.py      # 主程序文件
├── cuda_detection.py      # CUDA检测模块
├── test_path.py           # 测试路径模块
├── README.md              # 项目说明文档
├── Output/                # 输出目录（自动创建）
│   ├── AudioReport.html   # HTML报告
│   └── AudioReport.xlsx   # Excel报告
└── Temp/                  # 临时目录（自动创建和清理）
```

## 核心功能说明

### CUDA GPU加速
- 程序自动检测NVIDIA GPU和CUDA支持
- 如果支持，将使用GPU加速处理音频文件
- 可以同时使用CPU和GPU进行并行处理
- 提供更好的性能和更快的处理速度

### 伪HiRes检测
- 分析音频文件的高频能量分布
- 检测是否存在不自然的频谱特征
- 识别被人为拉伸或插值的伪高解析度音频
- 提供可靠的检测结果

### 音质等级评估
- 根据行业标准划分音质等级
- 考虑采样率、位深度和音频格式
- 提供直观的音质评价

## 常见问题

### 1. 程序无法运行
- 确保已正确安装Python和所有依赖库
- 确保FFmpeg已正确安装并添加到系统PATH
- 检查是否有足够的磁盘空间

### 2. GPU加速未启用
- 确保您的NVIDIA显卡支持CUDA
- 确保已安装最新的NVIDIA驱动程序
- 确保FFmpeg版本支持CUDA加速

### 3. 报告中缺少某些信息
- 某些音频文件可能不包含完整的元数据
- 伪HiRes检测可能对某些特殊格式的文件无法给出明确结果

### 4. 重复文件检测不准确
- 程序使用文件哈希值进行重复检测，确保文件内容完全相同
- 不同格式的相同音频将被视为不同文件

## 性能优化建议
- 使用支持CUDA的NVIDIA显卡以启用GPU加速
- 确保GPU驱动程序为最新版本，以获得最佳性能

## 许可证

本项目采用MIT许可证。详见LICENSE文件。

## 更新日志

### v1.0.0
- 初始版本发布
- 支持CUDA GPU加速
- 实现音频质量评估
- 支持伪HiRes检测
- 生成HTML和Excel报告

**使用提示**：程序运行过程中会生成临时文件，分析完成后会自动清理。建议在运行前关闭其他占用大量系统资源的程序，以获得最佳性能。